<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <head th:replace="fragments/head :: head"></head>
    <body>
        <nav th:replace="fragments/navbar :: navbar"></nav>


        <div class="container">
        <div class="row">
            <div class="d-flex justify-content-center mt-5">
                <h1 th:text="${title}"></h1>
            </div>
            <hr class="my-4">
        </div>

        <div class="row justify-content-center mb-5">
            <div class="col-6 mb-5">
                <form class="needs-validation" th:action="@{/empleado/__${action}__}" method="post" th:object="${empleado}" novalidate>

                    <div class="mb-3">
                        <label for="nombre" class="form-label">Nombre</label>
                        <input type="text" class="form-control" name="nombre" id="nombre" th:field="*{nombre}" placeholder="Ingresar Nombre" required>
                        <div class="valid-feedback"></div> 
                        <div class="invalid-feedback">Ingresar Nombre valido</div>                     
                    </div>

                    <div class="mb-3">
                        <label for="apellido" class="form-label">Apellido</label>
                        <input type="text" class="form-control" name="apellido" id="apellido" th:field="*{apellido}" placeholder="Ingresar apellido" required>
                        <div class="valid-feedback"></div> 
                        <div class="invalid-feedback">Ingresar Apellido valido</div>  
                    </div>

                    <div class="mb-3">
                        <label for="usuario" class="form-label">Usuario</label>
                        <input type="text" class="form-control" name="usuario" id="usuario" th:field="*{usuario}" placeholder="Ingresar usuario" required>
                        <div class="valid-feedback"></div> 
                        <div class="invalid-feedback">Ingresar usuario valido</div>
                    </div>

                    <div class="mb-3">
                        <label for="clave" class="form-label">Clave</label>
                        <input type="password" class="form-control" name="clave" id="clave" th:field="*{clave}" placeholder="Ingresar clave" >
                        <div class="valid-feedback"></div> 
                        <div class="invalid-feedback">Ingresar clave valida</div>
                    </div>

                    <div sec:authorize="hasRole('ADMIN')" class="input-group mb-3">
                        <select class="form-select" th:field="*{rol}" id="rol" aria-describedby="rol" required>
                            <option value="">Elegir ROL</option>
                            <option th:if="${action == 'guardar'}" th:each=" rol : ${T(egg.GestionVideojuegos.enums.Rol).values()}" th:text="${rol}" th:value="${rol}"></option>
                            <option th:if="${action == 'modificar'}" th:each=" rol : ${T(egg.GestionVideojuegos.enums.Rol).values()}" th:text="${rol}" th:value="${rol}" th:selected="${rol==empleado.id}"></option>
                        </select>
                        <div class="valid-feedback"></div>
                        <div id="autor" class="invalid-feedback">
                            Ingresar un Rol valido
                        </div>
                    </div>

                    <input th:if="${action == 'modificar'}" type="hidden" th:name="id" th:field="*{id}">
                    
                    <button class="btn btn-primary" th:text="${action == 'guardar'} ? 'Crear empleado' : 'Guardar cambios'" type="submit"></button>
                </form>
            </div>
        </div>
    </div>


        <footer th:replace="fragments/footer :: footer"></footer>        
        <script th:src="@{/assets/bootstrap.bundle.min.js}"></script>
    </body>

    <script>
        (function () {
        'use strict'
    
        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.querySelectorAll('.needs-validation')
    
        // Loop over them and prevent submission
        Array.prototype.slice.call(forms)
        .forEach(function (form) {
            form.addEventListener('submit', function (event) {
            if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()
            }
    
            form.classList.add('was-validated')
            }, false)
        })
        })()
    
        var y = new Date().getFullYear();
        document.getElementById('anio').innerHTML = y
    </script>
</html>
